import{r as f,o as x,n as M,a as h,c as y,b as d,t as g,u as _,F as N,d as O,w as k,e as I}from"./vendor.3698f535.js";const D=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function l(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(e){if(e.ep)return;e.ep=!0;const t=l(e);fetch(e.href,t)}};D();const m=c=>c>9?c:`0${c}`;function w(c){const r=new Date(c),l=r.getFullYear(),s=m(r.getMonth()+1),e=m(r.getDate()),t=m(r.getHours()),i=m(r.getMinutes()),p=m(r.getSeconds());return`${l}/${s}/${e} ${t}:${i}:${p}`}const E={class:"contianer"},j={style:{"text-align":"center",color:"rgb(99, 180, 71)"}},B={class:"msg-box"},F={class:"input-box"},K=["onKeyup"],A={setup(c){function r(o){var n=new RegExp("(^|&)"+o+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(n);return a!=null?unescape(a[2]):null}const l=f([]);let s=r("room");console.log("roomid",s),s||(s="lxhyl",l.value.push(`You didn't join any rooms.There are default room.add room name behind url to join. 
         eg. join room 'lxhyl':
          114.132.210.203/chat?room=lxhyl
  `));let e=f("");const t=new WebSocket("ws://114.132.210.203:5002");t.addEventListener("open",function(o){t.send(JSON.stringify({roomid:s,type:"connect"}))}),t.addEventListener("message",function(o){const n=JSON.parse(o.data||null);console.log("rcvMsg",n),n.roomid===s&&e.value!==n.from&&l.value.push(`[${w(n.date)}@${n.from}]# ${n.data}`)});const i=o=>{const n="text",a=e.value,u=Date.now(),v=o.target.value;if(!v)return;const L=`[${w(u)}@${a}]# ${v}`;l.value.push(L),o.target.scrollIntoView(),o.target.value="";const b={roomid:s,type:n,data:v,from:a,date:u};console.log(b),t.send(JSON.stringify(b))};let p=f("");setInterval(()=>{const o=w(Date.now());p.value=o},1e3);const $=f(null);function S(o){o.target.focus()}return x(()=>{M(()=>{$.value.focus()})}),x(()=>{const o=localStorage.getItem("username");if(o)console.log("lcUsername",o),e.value=o;else{const n=prompt("\u600E\u4E48\u79F0\u547C\u4F60\uFF1F","");console.log("name",n),e.value=n,localStorage.setItem("username",e.value)}l.value.push(`Welcome, ${e.value}`)}),(o,n)=>(h(),y("div",E,[d("p",j,g(_(s)),1),d("div",B,[(h(!0),y(N,null,O(l.value,(a,u)=>(h(),y("p",{class:"animate__animated animate__zoomInUp",key:u,style:{"white-space":"pre-wrap"}},g(a),1))),128)),d("p",F,[d("span",null,"["+g(_(p))+"@"+g(_(e))+"]#\xA0",1),d("input",{ref:(a,u)=>{u.input=a,$.value=a},onKeyup:k(i,["enter"]),onBlur:S},null,40,K)])])]))}};I(A).mount("#app");
